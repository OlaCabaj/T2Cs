#' Plots a heatmap of a normalized interaction matrix
#'
#' @param truncated_m a binned contact-matrix generated by \code{truncate_matrix} function.
#' @param black_cells A data frame of array indices generated by \code{blackout_cells} function.
#' @param title A plot title, default = T2C results.
#' @param colors_palette colors passed to \code{colorRampPalette} function.
#' 
#' @return A heatmap3 plot of contacts.
#'
#' @export
#' @importFrom heatmap3 heatmap3
#' @importFrom grDevices colorRampPalette
plot_results <- function(truncated_m, black_cells, title = "T2C results", colors_palette = c("blue","deepskyblue2","green","yellow","orange","red","red3")) {

  # tests
  if(missing(truncated_m)) stop('missing truncated_m')
  if(!'truncated_m' %in% class(truncated_m)) stop('wrong class of truncated_m')
  if(missing(black_cells)) stop('black_cells')
  
  rainbows <- colorRampPalette(colors_palette)(600)

  heatmap_t2c <- heatmap3::heatmap3(
    as.matrix(truncated_m * (upper.tri(truncated_m, diag = TRUE))),
    Rowv = NA, Colv = NA, col = rainbows, symm = TRUE, main = title,
    colorCell = black_cells, labRow = FALSE, labCol = FALSE
  )
  return(invisible(heatmap_t2c))
}

